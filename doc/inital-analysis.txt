Inital analysis without access to any documentation

Discussion: https: //www.facebook.com/groups/greaseweazle/posts/4610561185696133/

Example file set: https://drive.google.com/file/d/1ZcHDwdnxNBubBTMhc0f95JAOiSClFhK1/view


Disk structure


Block 0: Disk label

00000000   42 30 30 31  00 01 00 00  00 01 00 01  00 00 00 02  B001............
00000010   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000020   00 00 00 00  04 49 42 41  43 4B 55 50  31 20 20 20  .....IBACKUP1
00000030   20 20 20 20  20 20 20 20  20 20 30 34  32 30 A4 59            0420.Y
00000040   0F 1E 2D 3C  4B 5A 69 78  87 96 A5 B4  C3 D2 E1 F0  ..-<KZix........
00000050   0F 1E 2D 3C  4B 5A 69 78  87 96 A5 B4  C3 D2 E1 F0  ..-<KZix........
00000060   F1 F2 F4 F8  F9 FA FC FE  FF 7F BF DF  EF 6F AF CF  .............o..
00000070   4F 8F 0F 07  0B 0D 0E 06  0A 0C 04 08  04 02 01 00  O...............
00000080   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000090   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000000A0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000000B0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000000C0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000000D0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000000E0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000000F0   00 00 00 00  00 00 00 00  45 58 4F 52  4D 41 43 53  ........EXORMACS

Block 1: Sector allocation bitmap?

00000100   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000110   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000120   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000130   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000140   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000150   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000160   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000170   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000180   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000190   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
000001A0   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
000001B0   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
000001C0   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
000001D0   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
000001E0   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
000001F0   FF FF FF FF  FF FF FF FF  FE 00 3F FF  FF FF FF FF  ..........?.....

Block 2: Directory/set table

00000200   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000210   00 01 4D 32  35 4D 58 41  42 45 00 00  00 03 00 00  ..M25MXABE......
00000220   00 01 20 20  20 20 20 20  20 20 00 00  00 55 00 00  ..        ...U..
00000230   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000240   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000250   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000260   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000270   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000280   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000290   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000002A0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000002B0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000002C0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000002D0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000002E0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000002F0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................

Block 3-: File table.  (start given by directory/set table)

00000300   00 00 00 00  00 01 4D 32  35 4D 58 41  42 45 00 00  ......M25MXABE..
00000310   41 43 54 20  20 20 20 20  52 54 00 00  00 00 00 07  ACT     RT......
00000320   00 00 01 47  00 00 00 00  00 00 00 00  00 00 00 00  ...G............
00000330   00 00 00 00  00 00 04 49  04 49 00 00  00 00 00 00  .......I.I......
00000340   00 00 43 59  43 20 20 20  20 20 52 54  00 00 00 00  ..CYC     RT....
00000350   01 4F 00 00  00 87 00 00  00 00 00 00  00 00 00 00  .O..............
00000360   00 00 00 00  00 00 00 00  04 49 04 49  00 00 00 00  .........I.I....
00000370   00 00 00 00  44 49 52 20  20 20 20 20  52 54 00 00  ....DIR     RT..
00000380   00 00 01 D7  00 00 05 EF  00 00 00 00  00 00 00 00  ................
00000390   00 00 00 00  00 00 00 00  00 00 04 49  04 49 00 00  ...........I.I..
000003A0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000003B0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000003C0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000003D0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................

***** Directory/set table *****

Unknown
  00000200   00 00 00 00  00 00 00 00  00 00 00 00  00 00        |..............|
First entry
  00000200                                                00 00                |..|
  00000210   00 01 4D 32  35 4D 58 41  42 45 00 00  00 03        |..M25MXABE....|
Second entry
  00000210                                                00 00                |..|
  00000220   00 01 20 20  20 20 20 20  20 20 00 00  00 55        |..        ...U|
End of table?
  00000220                                                00 00                |..|
  00000230   00 00                                               |..|              

Exact alignment uncertain. Maybe the entry starts two bytes later.

** Directory/set table entry *** (0x10 bytes each)

valid?
  00000000   00 00 00 01                          |....|
name
  00000004   4D 32 35 4D 58 41 42 45              |M25MXABE|
first block
  0000000C   00 00 00 03                          |....|

***** File table *****

unknown
  00000300   00 00 00 00  00 01                                  |......|

directory/set name
  00000300                      4D 32  35 4D 58 41  42 45 00 00  |M25MXABE..|
Note: Unclear if the trailing 00 00 is part of the name, or the first entry
probably part of the name.

First file table entry
  00000310   41 43 54 20  20 20 20 20  52 54 00 00  00 00 00 07  ACT     RT......
  00000320   00 00 01 47  00 00 00 00  00 00 00 00  00 00 00 00  ...G............
  00000330   00 00 00 00  00 00 04 49  04 49 00 00  00 00 00 00  .......I.I......
  00000340   00 00                                               ..              

Second entry
  00000340         43 59  43 20 20 20  20 20 52 54  00 00 00 00    CYC     RT....
  00000350   01 4F 00 00  00 87 00 00  00 00 00 00  00 00 00 00  .O..............
  00000360   00 00 00 00  00 00 00 00  04 49 04 49  00 00 00 00  .........I.I....
  00000370   00 00 00 00                                         ....            

[...]

** File table entry (0x32 bytes each) **

file name
  00000000   41 43 54 20  20 20 20 20  52 54 00 00               |ACT     RT..|

starting block
  00000000                                          00 00 00 07  |....|

number of blocks - 1
  00000010   00 00 01 47                                         |...G|

unknown
  00000010                00 00 00 00  00 00 00 00  00 00 00 00      ............
  00000020   00 00 00 00  00 00 04 49  04 49 00 00  00 00 00 00  .......I.I......
  00000030   00 00                                               ..              

Actual file size is one block more than the size field, but uncertain if the
first block is part of the file. Contains the same almost empty data in all
files. But probably it belongs to the file. In continuation images the first
block clearly is file content and not a header.



*** Last file set ***

The '        ' fileset is different. Lots of data in the unknown section after
the filename, and file content refers to another sector with additional data.
also the size field is not used, contains the block number.

00005500   00 00 00 00  00 01 20 20  20 20 20 20  20 20 00 00  ......        ..
00005510   44 49 46 31  20 20 20 20  53 41 00 00  00 00 00 5D  DIF1    SA.....]
00005520   00 00 00 5D  00 00 00 00  00 00 00 05  00 00 01 04  ...]............
00005530   00 1A 00 00  01 04 04 49  04 49 00 00  00 00 00 00  .......I.I......
00005540   00 00 44 49  46 32 20 20  20 20 53 41  00 00 00 00  ..DIF2    SA....
00005550   00 62 00 00  00 62 00 00  00 00 00 00  00 13 00 00  .b...b..........
00005560   01 04 00 08  00 00 01 04  04 49 04 49  00 00 00 00  .........I.I....
00005570   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................

DIF1    .SA    block=93       00 00 00 00 00 00 00 05 00 00 01 04 00 1A 00 00 01 04 04 49 04 49 00 00 00 00 00 00 00 00
DIF2    .SA    block=98       00 00 00 00 00 00 00 13 00 00 01 04 00 08 00 00 01 04 04 49 04 49 00 00 00 00 00 00 00 00

DIF1.SA block 93:

00005D00   00 00 00 00  00 00 00 00  02 00 00 00  00 59 00 06  .............Y..
00005D10   01 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005D20   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005D30   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005D40   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005D50   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005D60   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005D70   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005D80   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005D90   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005DA0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005DB0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005DC0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005DD0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005DE0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005DF0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................

which in bytes 10-13 refers to block 0x59 which again lists the files in the
backup set and some additional data, the file names and their sizes. 

unclear how it knows which file is on which disk here, or what the data before
the file names represents.

00005900   01 01 53 03  1E 00 00 00  00 05 00 00  00 14 00 5F  ..S............_
00005910   39 54 00 5F  6B 60 02 00  03 53 4D 32  35 4D 58 41  9T._k`...SM25MXA
00005920   42 45 41 43  54 20 20 20  20 20 52 54  00 00 01 48  BEACT     RT...H
00005930   00 00 01 48  4D 32 35 4D  58 41 42 45  43 59 43 20  ...HM25MXABECYC
00005940   20 20 20 20  52 54 00 00  00 88 00 00  00 88 4D 32      RT........M2
00005950   35 4D 58 41  42 45 44 49  52 20 20 20  20 20 52 54  5MXABEDIR     RT
00005960   00 00 10 A8  00 00 10 A8  4D 32 35 4D  58 41 42 45  ........M25MXABE
00005970   46 49 58 20  20 20 20 20  52 54 00 00  00 D0 00 00  FIX     RT......
00005980   00 D0 4D 32  35 4D 58 41  42 45 46 54  58 20 20 20  ..M25MXABEFTX
00005990   20 20 52 54  00 00 61 C8  00 00 61 C8  00 00 00 00    RT..a...a.....
000059A0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000059B0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000059C0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000059D0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000059E0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000059F0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................



DIF2.SA block 98:

00006200   00 00 00 00  00 00 00 00  02 00 00 00  00 5E 00 14  .............^..
00006210   01 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00006220   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00006230   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00006240   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00006250   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00006260   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00006270   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00006280   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00006290   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000062A0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000062B0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000062C0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000062D0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000062E0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000062F0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................

which in bytes 10-13 refers to block 0x5E and byte 14-15 seems to be number of
entries, and each entry refers to a disk number.
There seems to be as many disk number entries as there is file fragments.
Disks with more than one file is listed as many times as there is files
on the disk.

00005E00   00 00 00 01  42 30 30 31  00 00 00 02  42 30 30 31  ....B001....B001
00005E10   00 00 00 03  42 30 30 31  00 00 00 03  42 30 30 32  ....B001....B002
00005E20   00 00 00 03  42 30 30 33  00 00 00 04  42 30 30 33  ....B003....B003
00005E30   00 00 00 05  42 30 30 33  00 00 00 05  42 30 30 34  ....B003....B004
00005E40   00 00 00 05  42 30 30 35  00 00 00 05  42 30 30 36  ....B005....B006
00005E50   00 00 00 05  42 30 30 37  00 00 00 05  42 30 30 38  ....B007....B008
00005E60   00 00 00 05  42 30 30 39  00 00 00 05  42 30 31 30  ....B009....B010
00005E70   00 00 00 05  42 30 31 31  00 00 00 05  42 30 31 32  ....B011....B012
00005E80   00 00 00 05  42 30 31 33  00 00 00 05  42 30 31 34  ....B013....B014
00005E90   00 00 00 05  42 30 31 35  00 00 00 05  42 30 31 36  ....B015....B016
00005EA0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005EB0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005EC0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005ED0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005EE0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00005EF0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................

