Simple program to dump files from EXORMACS backup sets

This application analyzes an image file and extracts any files
found with. The output folder should be empty before analyzing
a new set of images as data is appended to each file to handle
files crossing several image files

  ./analyze -o output_folder image_files...

Discussion: https: //www.facebook.com/groups/greaseweazle/posts/4610561185696133/

Example file set: https://drive.google.com/file/d/1ZcHDwdnxNBubBTMhc0f95JAOiSClFhK1/view


Disk structure


Block 0: Disk label / boot sector.

00000000   42 30 30 31  00 01 00 00  00 01 00 01  00 00 00 02  B001............
00000010   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000020   00 00 00 00  04 49 42 41  43 4B 55 50  31 20 20 20  .....IBACKUP1
00000030   20 20 20 20  20 20 20 20  20 20 30 34  32 30 A4 59            0420.Y
00000040   0F 1E 2D 3C  4B 5A 69 78  87 96 A5 B4  C3 D2 E1 F0  ..-<KZix........
00000050   0F 1E 2D 3C  4B 5A 69 78  87 96 A5 B4  C3 D2 E1 F0  ..-<KZix........
00000060   F1 F2 F4 F8  F9 FA FC FE  FF 7F BF DF  EF 6F AF CF  .............o..
00000070   4F 8F 0F 07  0B 0D 0E 06  0A 0C 04 08  04 02 01 00  O...............
00000080   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000090   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000000A0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000000B0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000000C0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000000D0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000000E0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000000F0   00 00 00 00  00 00 00 00  45 58 4F 52  4D 41 43 53  ........EXORMACS

Block 1: Unknown / unused?

00000100   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000110   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000120   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000130   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000140   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000150   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000160   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000170   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000180   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
00000190   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
000001A0   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
000001B0   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
000001C0   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
000001D0   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
000001E0   FF FF FF FF  FF FF FF FF  FF FF FF FF  FF FF FF FF  ................
000001F0   FF FF FF FF  FF FF FF FF  FE 00 3F FF  FF FF FF FF  ..........?.....

Block 2: Directory/set table

00000200   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000210   00 01 4D 32  35 4D 58 41  42 45 00 00  00 03 00 00  ..M25MXABE......
00000220   00 01 20 20  20 20 20 20  20 20 00 00  00 55 00 00  ..        ...U..
00000230   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000240   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000250   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000260   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000270   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000280   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
00000290   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000002A0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000002B0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000002C0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000002D0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000002E0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000002F0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................

Block 3-: File table.  (start given by directory/set table)

00000300   00 00 00 00  00 01 4D 32  35 4D 58 41  42 45 00 00  ......M25MXABE..
00000310   41 43 54 20  20 20 20 20  52 54 00 00  00 00 00 07  ACT     RT......
00000320   00 00 01 47  00 00 00 00  00 00 00 00  00 00 00 00  ...G............
00000330   00 00 00 00  00 00 04 49  04 49 00 00  00 00 00 00  .......I.I......
00000340   00 00 43 59  43 20 20 20  20 20 52 54  00 00 00 00  ..CYC     RT....
00000350   01 4F 00 00  00 87 00 00  00 00 00 00  00 00 00 00  .O..............
00000360   00 00 00 00  00 00 00 00  04 49 04 49  00 00 00 00  .........I.I....
00000370   00 00 00 00  44 49 52 20  20 20 20 20  52 54 00 00  ....DIR     RT..
00000380   00 00 01 D7  00 00 05 EF  00 00 00 00  00 00 00 00  ................
00000390   00 00 00 00  00 00 00 00  00 00 04 49  04 49 00 00  ...........I.I..
000003A0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000003B0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000003C0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................
000003D0   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00  ................

***** Directory/set table *****

Unknown
  00000200   00 00 00 00  00 00 00 00  00 00 00 00  00 00        |..............|
First entry
  00000200                                                00 00                |..|
  00000210   00 01 4D 32  35 4D 58 41  42 45 00 00  00 03        |..M25MXABE....|
Second entry
  00000210                                                00 00                |..|
  00000220   00 01 20 20  20 20 20 20  20 20 00 00  00 55        |..        ...U|
End of table?
  00000220                                                00 00                |..|
  00000230   00 00                                               |..|              

Exact alignment uncertain. Maybe the entry starts two bytes later.

** Directory/set table entry *** (0x10 bytes each)

valid?
  00000000   00 00 00 01                          |....|
name
  00000004   4D 32 35 4D 58 41 42 45              |M25MXABE|
first block
  0000000C   00 00 00 03                          |....|

***** File table *****

unknown
  00000300   00 00 00 00  00 01                                  |......|

directory/set name
  00000300                      4D 32  35 4D 58 41  42 45 00 00  |M25MXABE..|
Note: Unclear if the trailing 00 00 is part of the name, or the first entry
probably part of the name.

First file table entry
  00000310   41 43 54 20  20 20 20 20  52 54 00 00  00 00 00 07  ACT     RT......
  00000320   00 00 01 47  00 00 00 00  00 00 00 00  00 00 00 00  ...G............
  00000330   00 00 00 00  00 00 04 49  04 49 00 00  00 00 00 00  .......I.I......
  00000340   00 00                                               ..              

Second entry
  00000340         43 59  43 20 20 20  20 20 52 54  00 00 00 00    CYC     RT....
  00000350   01 4F 00 00  00 87 00 00  00 00 00 00  00 00 00 00  .O..............
  00000360   00 00 00 00  00 00 00 00  04 49 04 49  00 00 00 00  .........I.I....
  00000370   00 00 00 00                                         ....            

[...]

** File table entry (0x32 bytes each) **

file name
  00000000   41 43 54 20  20 20 20 20  52 54 00 00               |ACT     RT..|

starting block
  00000000                                          00 00 00 07  |....|

number of blocks - 1
  00000010   00 00 01 47                                         |...G|

unknown
  00000010                00 00 00 00  00 00 00 00  00 00 00 00      ............
  00000020   00 00 00 00  00 00 04 49  04 49 00 00  00 00 00 00  .......I.I......
  00000030   00 00                                               ..              

Actual file size is one block more than the size field, but uncertain if the
first block is part of the file. Contains the same almost empty data in all
files. But probably it belongs to the file. In continuation images the first
block clearly is file content and not a header.

